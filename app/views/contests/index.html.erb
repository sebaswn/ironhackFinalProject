<%= render "layouts/navbar" %>
<p id="notice"><%= notice %></p>

<%= link_to 'New Contest', new_contest_path %>
<h1>Listing Contests</h1>

<strong><h1>Open Competitions Competition</h2></strong>

<% @contests.each do |contest| %>
        <% if contest.uploadBy <= Date.today && contest.voteBy > Date.today %>

          <div data-id="<%=contest.id%>" class="active">
            <img data-id="<%=contest.id%>" src="<%=contest.cover.url(:long)%>">
            
              <div class="title"><h1><%=contest.name%></h1></div>
              <div class="description"><h2><%=contest.description%></h1></div>
              <div class="links">
                <% if current_user.role == "mod" %>
                  <h3><%= link_to 'Edit', edit_contest_path(contest), :class => 'link' %></h4>
                  <h3><%= link_to 'Destroy', contest, method: :delete, data: { confirm: 'Are you  sure?'}, :class => 'link'  %></h4>
                <% end %>
                  <h3><%= link_to 'Show', contest, :class => 'link' %></h4>
                <% contest.users.each do |user| %>
                  <% if user.id != current_user.id %>
                    <% @userEntered = false %>
                  <%else%>
                    <% @userEntered = true %>
                    <% break %>
                  <%end%>
                <%end%>

                <% if @userEntered == false || contest.users.size == 0 %>
                  <h3><%= link_to 'Enter', contest_enter_path(contest), :class => 'link' %></h4>
                <%end%>
              </div>
          </div>
        <% end %>
        </div> 
      <% end %>


<strong><h1>Closed Competition</h2></strong>

<% @contests.each do |contest| %>
        <% if contest.voteBy <= Date.today && contest.endBy > Date.today %>

          <div data-id="<%=contest.id%>" class="active">
            <img data-id="<%=contest.id%>" src="<%=contest.cover.url(:long)%>">
            
              <div class="title"><h1><%=contest.name%></h1></div>
              <div class="description"><h2><%=contest.description%></h1></div>
              <div class="links">
                <% if current_user.role == "mod" %>
                  <h3><%= link_to 'Edit', edit_contest_path(contest), :class => 'link' %></h4>
                  <h3><%= link_to 'Destroy', contest, method: :delete, data: { confirm: 'Are you  sure?'}, :class => 'link'  %></h4>
                <% end %>
                <h3><%= link_to 'Show', contest, :class => 'link' %></h4>

                <% contest.votes.each do |vote| %>
                  <% if vote.user_id != current_user.id %>
                    <% @userVoted = false %>
                  <%else%>
                    <% @userVoted = true %>
                    <% break %>
                  <%end%>
                <%end%>
                
                <% if @userVoted == false || contest.votes.size == 0 %>
                  <h3><%= link_to 'Vote', contest_vote_path(contest), :class => 'link' %></h3>
                <%end%>
      
              </div>
          </div>
        <% end %>
        </div> 
      <% end %>


<strong><h1>Locked Competition</h2></strong>

<% @contests.each do |contest| %>
        <% if contest.endBy <= Date.today%>

          <div data-id="<%=contest.id%>" class="active">
            <img data-id="<%=contest.id%>" src="<%=contest.cover.url(:long)%>">
            
              <div class="title"><h1><%=contest.name%></h1></div>
              <div class="description"><h2><%=contest.description%></h1></div>
              <div class="links">
                <% if current_user.role == "mod" %>
                  <h3><%= link_to 'Edit', edit_contest_path(contest), :class => 'link' %></h4>
                  <h3><%= link_to 'Destroy', contest, method: :delete, data: { confirm: 'Are you  sure?'}, :class => 'link'  %></h4>
                <% end %>

                  <h3><%= link_to 'Show', contest, :class => 'link' %></h4>
                
              </div>
          </div>
        <% end %>
        </div> 
      <% end %>







<script>

  $(".title").hide();
  $(".links").hide();
  $(".description").hide();
  $(".link").css("color", "white");
  $(".linkToUser").css("color", "white");

$(".active").mouseover(function(){
  console.log("hello");
  $(this).children(".title").show();
  $(this).children(".links").show();
  $(this).children(".description").show();
  $(this).children('img').css("opacity","0.5");
  $(this).children('img').css("filter","alpha(opacity=50)");
});

$(".link").hover(function(){
  $(this).css("background-color", "transparent");
  $(this).css("color", "white");
});

$(".linkToUser").hover(function(){
  $(this).css("background-color", "transparent");
  $(this).css("color", "white");
});

$(".active").mouseout(function(){
  $(this).children('img').css("opacity","1");
  $(".title").hide();
  $(".photographer").hide();
  $(this).children(".description").hide();
  $(".links").hide();
  $(this).children('img').css("filter","alpha(opacity=100)");
});



</script>


<style>
.jumbotron{
  background-color: black;
  color: white;
}
.linkOptions{
  color: white;
  padding-left: 7px;

}


.active {
    background-color: black;
    position:relative; 
  
}
h3 {
    margin-top: 0px;
    margin-bottom: 5px;
}

 h6 {
    margin-top: 0px;
    margin-bottom: 0px;
}

 body{
  background-color: #EDEDED;
 }

.title {
    position: absolute; 
    width: 100%;
    text-align: center;
    height: 0px; 
    right: 0; 
    top: 15%; 
    bottom: 0; 
    background: red; 
    color:white;
    font-family: 'Slabo 27px', serif;
}
.description {
    position: absolute; 
    width: 100%;
    text-align: center;
    height: 0px; 
    right: 0; 
    top: 30%; 
    bottom: 0; 
    background: red; 
    color:white;
    font-family: 'Slabo 27px', serif;
}

.links {
    position: absolute; 
    width: 100%;
    text-align: center;
    height: 0px; 
    right: 0; 
    top: 70%; 
    bottom: 0; 
    background: red; 
    color: white;
    font-family: 'Slabo 27px', serif;
}


#container {
  width: 1200px;
  margin: 0 auto;
  padding-left: 0px;
}

</style>